<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html">
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<title>ЯРомхакеръ. Ромхакинг NES. Центральный процессор. Основные режимы адресации процессора 6502</title>
		<meta name="description" content="Подробное описание режимов адресации Immediate, Zero Page и Absolute">
		<meta name="keywords" content="">
		<link rel="icon" href="https://iromhacker.ru/favicon.png" type="image/png">
		<link href="style_test.css" rel="stylesheet">
		<script src="https://iromhacker.ru/analytics.js"></script>
		<script src="https://iromhacker.ru/bitrix24.js" async></script>
	</head>
	<body>
		<h1>Основные режимы адресации</h1>
		<p>
			<center>
				<a href="https://iromhacker.ru/nes/ru/index.html">Вернуться на главную страницу</a>
			</center>
		</p>
		<br>
		<p class="content">
			Содержание
		</p>
		<ul>
			<li><a href="../1/index.html">Справочник по командам процессора</a></li>
			<li>Основные режимы адресации</li>
			<ul>
				<li>Дополнительные режимы адресации</li>
				<li>Прочие режимы адресации</li>
			</ul>
		</ul>
		<h2>Основные режимы адресации</h2>
		<p>
			Режим адресации (адресация памяти) - способ обращения процессора к своей памяти.
		</p>
		<p>
			Любая инструкция процессора состоит как минимум из опкода команды. В зависимости от выбранного режима адресации, после опкода может быть дополнительно записан операнд (аргумент) этой команды размером 1 или 2 байта. В итоге получается инструкция размером от 1-го до 3-х байтов.
		</p>
		<p class="tip">
			Разные команды могут использовать один и тот же режим адресации. У одних команд может быть больше выбора режимов адресации, чем у других.
		</p>
		<h3>Immediate</h3>
		<p>
			Непосредственная адресация. Используется для работы с константами, то есть с неизменяемыми значениями, записанными в самой программе. Например, можно задать начальное количество жизней и прочитать его одним из регистров.
		</p>
		<p>
			Операнд команды размером 1 байт, им указывается константа, с которым будет работать эта команда.
		</p>
		<debugger>
<div class="debugger"> 00:8100: A0 0F     <text class="opcode">LDY #</text><text class="address">$0F</text>	; загрузить байт #$0F в регистр Y</div>
<div class="debugger"> 00:8102: E0 33     <text class="opcode">CMX #</text><text class="address">$33</text>	; сравнить регистр X с байтом #$33</div>
<div class="debugger"> 00:8104: 69 1C     <text class="opcode">ADC #</text><text class="address">$1C</text>	; сложить регистр A с байтом #$1C</div>
		</debugger>
		
		1111
		
		<p>
			<table class="debugger" border=0 cellspacing=0 cellpadding=0>
				<tr>
					<td>00:8100: A0 0F     <text class="opcode">LDY #</text><text class="address">$0F</text>	; загрузить байт #$0F в регистр Y</td>
				</tr>
				<tr>
					<td>00:8102: E0 33     <text class="opcode">CMX #</text><text class="address">$33</text>	; сравнить регистр X с байтом #$33</td>
				</tr>
				<tr>
					<td>00:8104: 69 1C     <text class="opcode">ADC #</text><text class="address">$1C</text>	; сложить регистр A с байтом #$1C</td>
				</tr>
			</table>
		</p>
		<p class="debugger">
 00:8100: A0 0F     <text class="opcode">LDY #</text><text class="address">$0F</text>	; загрузить байт #$0F в регистр Y
 00:8102: E0 33     <text class="opcode">CMX #</text><text class="address">$33</text>	; сравнить регистр X с байтом #$33
 00:8104: 69 1C     <text class="opcode">ADC #</text><text class="address">$1C</text>	; сложить регистр A с байтом #$1C
		</p>
		<p class="debugger">
 00:8100: A0 0F     <text class="opcode">LDY #</text><text class="address">$0F</text>	; загрузить байт #$0F в регистр Y<br>
 00:8102: E0 33     <text class="opcode">CMX #</text><text class="address">$33</text>	; сравнить регистр X с байтом #$33<br>
 00:8104: 69 1C     <text class="opcode">ADC #</text><text class="address">$1C</text>	; сложить регистр A с байтом #$1C<br>
		</p>
		<p class="debugger">
 00:8100: A0 0F     <text class="opcode">LDY #</text><text class="address">$0F</text>	; загрузить байт #$0F в регистр Y<br class="debugger1">
 00:8102: E0 33     <text class="opcode">CMX #</text><text class="address">$33</text>	; сравнить регистр X с байтом #$33<br class="debugger1">
 00:8104: 69 1C     <text class="opcode">ADC #</text><text class="address">$1C</text>	; сложить регистр A с байтом #$1C<br class="debugger1">
		</p>
		<p class="tip">
			Чтобы команда LDY использовала режим адресации Immediate, она записывается с помощью опкода A0. А чтобы загрузить в регистр Y байт #$0F, после опкода ставится операнд 0F.
		</p>
		<h3>Zero Page</h3>
		<p>
			Адресация нулевой страницы. Нулевой страницей являются адреса RAM в диапазоне $0000-$00FF. Старший байт адресов этого диапазона = #$00, поэтому страница называется "нулевая".
		</p>
		<p>
			Эта 8-битная адресация служит для экономии ресурсов процессора, поскольку затрачивает меньше тактов на выполнение команды по сравнению с режимом адресации Absolute.
		</p>
		<p class="tip">
			По этой причине данные, которые будут использованы кодом игры чаще, чем другие, обычно находятся именно в нулевой странице, чтобы снизить нагрузку на процессор при регулярной работе с этими данными. За счет сэкономленных тактов можно успеть выполнить больше кода за 1 кадр.
		</p>
		<p>
			Операнд команды размером 1 байт, им указывается младший байт адреса. А старший байт адреса всегда будет = #$00.
		</p>
		<p class="debugger">
 00:8100: 85 4D     <text class="opcode">STA</text> <text class="address">$4D</text>    ; записать байт из регистра A в адрес $004D
 00:8102: C6 03     <text class="opcode">DEC</text> <text class="address">$03</text>    ; уменьшить на #$01 байт в адресе $0003
 00:8104: 45 A1     <text class="opcode">EOR</text> <text class="address">$A1</text>    ; логическое ИЛИ байта из регистра A и байта из адреса $00A1
		</p>
		<p class="tip">
			Чтобы команда STA использовала режим адресации Zero Page, она записывается с помощью опкода 85. А чтобы записать байт из регистра A в адрес $004D, после опкода ставится операнд 4D.
		</p>
		<h3>Absolute</h3>
		<p>
			Абсолютная адресация. Полноценная 16-битная адресация, позволяет командам работать с любым адресом памяти процессора (NES Memory) в диапазоне $0000-$FFFF.
		</p>
		<p>
			Операнд команды размером 2 байта, имм указывается 16-битный адрес. Из-за особенностей архитектуры процессора, в операнде старший и младший байты адреса <text class="underline">всегда</text> записываются в обратном порядке, такой формат называется <a href="https://ru.wikipedia.org/wiki/%D0%9F%D0%BE%D1%80%D1%8F%D0%B4%D0%BE%D0%BA_%D0%B1%D0%B0%D0%B9%D1%82%D0%BE%D0%B2#%D0%9F%D0%BE%D1%80%D1%8F%D0%B4%D0%BE%D0%BA_%D0%BE%D1%82_%D0%BC%D0%BB%D0%B0%D0%B4%D1%88%D0%B5%D0%B3%D0%BE_%D0%BA_%D1%81%D1%82%D0%B0%D1%80%D1%88%D0%B5%D0%BC%D1%83" target="_blank">little-endian</a>.
		</p>
		<p class="debugger">
 00:8100: AE 23 01  <text class="opcode">LDX</text> <text class="address">$0123</text>    ; загрузить в регистр X байт из адреса $0123
 00:8103: 0E 45 03  <text class="opcode">ASL</text> <text class="address">$0345</text>    ; арифметический сдвиг битов влево у байта в адресе $0345
 00:8106: ED 09 00  <text class="opcode">SBC</text> <text class="address">$0009</text>    ; вычесть из регистра A байт из адреса $0009
		</p>
		<p class="tip">
			Чтобы команда LDX использовала режим адресации Absolute, она записывается с помощью опкода AE. А чтобы загрузить в регистр X байт из адреса $0123, после опкода ставится операнд 23 01.
		</p>
		<p class="tip">
			У команды SBC для указания адреса $0009 была выбрана абсолютная адресация, что потребует 4 такта на выполнение этой команды. Можно было бы получить точно такой же результат и сэкономить 1 такт, записав инструкцию как E5 09 для использования адресации нулевой страницы.
		</p>
		<script src="https://iromhacker.ru/spoiler.js"></script>
	</body>
</html>