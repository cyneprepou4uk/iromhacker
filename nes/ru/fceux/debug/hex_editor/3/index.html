<!DOCTYPE html>
<html>

	<head>
		<meta http-equiv="Content-Type" content="text/html">
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<title>Ромхакинг NES. Заморозка RAM адресов в окне Hex Editor</title>
		<meta name="description" content="Описание работы читов в окне Hex Editor эмулятора FCEUX. How to freeze bytes in RAM addresses via Hex Editor">
		<meta name="keywords" content="">
		<link rel="icon" href="https://iromhacker.ru/favicon.png" type="image/png">
		<link href="https://cyneprepou4uk.github.io/iromhacker/style.css" rel="stylesheet">
		<script src="https://iromhacker.ru/analytics.js"></script>
	</head>
	<body>
		<h1>Заморозка адресов</h1>
		<p>
			<center>
				<a class="return" href="https://iromhacker.ru/nes/ru/index.html">Вернуться на главную страницу</a>
			</center>
		</p>
		<p class="content">
			Содержание
		</p>
		<ul>
			<li><a href="../1/index.html">Окно Hex Editor</a></li>
			<li><a href="../2/index.html">Вкладка View</a></li>
			<li>Заморозка RAM адресов</li>
			<li><a href="../4/index.html">Прочие возможности окна</a></li>
		</ul>
		<h2>Заморозка RAM адресов</h2>
		<p class="tip">
			Заморозка напрямую связана с окном Cheats, которое открывается в эмуляторе FCEUX во вкладке Tools.
		</p>
		<p>
			Заморозка запрещает коду изменять байт в адресах RAM $0000-$07FF. Такая функция называется "созданием чита" в эмуляторах. Это бывает полезно во многих случаях, например:
		</p>
		<ol>
			<li>Помощь в определении значения адреса. Если байт заморожен, что-то в игре может перестать изменяться.</li>
			<li>Временное создание хака с вечными жизнями/патронами/таймером неуязвимости. Неуязвимость поможет сэкономить время, когда пытаешься дойти до нужного места в игре, особенно если немного увеличить скорость в эмуляторе.</li>
			<li>Фиксация координат врагов в некой точке, чтобы не мешались под ногами, или чтобы протестировать хитбоксы.</li>
			<li>Во время паузы эмулятора позволит насильно запихать в адрес нужный байт, когда игра постоянно перезаписывает твои ручные попытки изменить байт в RAM.</li>
		</ol>
		<p>
			Чтобы заморозить байт в адресе, нужно при необходимости поставить эмулятор на паузу, записать желаемый байт, а затем кликнуть по адресу правой кнопкой и выбрать Freeze/Unfreeze Address.
		</p>
		<p>
			<img src="2.png">
		</p>
		<button class="spoiler">Особенности заморозки</button>
		<div class="panel">
			<p>
				В некоторых случаях заморозка не будет работать с ожидаемым результатом. Заморозка лишь запрещает игре изменять байт в этом адресе, но она не запретит ей считать байт и произвести над ним какие-то отдельные вычисления.
			</p>
			<p>
				Если взять в пример игру Battle City, и заморозить байт #$01 в адресе с жизнями $0051 с целью получения бесконечных жизней, все равно будет вызыван Game Over после смерти игрока.
			</p>
			<p>
				Происходит это потому, что инструкция DEC, которая уменьшает байт в адресе, считывает этот байт, уменьшает на #$01, и затем пытается записать его обратно. Ей это не удается из-за заморозки адреса, однако результат уменьшения байта отобразится в состоянии процессора как Z = 1, поскольку в результате уменьшения получился байт #$00.
			</p>
			<p>
				Далее выполняется инструкция условного перехода, проверяющая на флаг Z, в результате которой будет вызван Game Over, несмотря на то, что в адресе с жизнями был заморожен байт #$01.
			</p>
			<p>
				Чтобы предотвратить такую ситуацию, нужно замораживать байт побольше, например #$02.
			</p>
			<p>
				Это относится не ко всем играм, а также схожая ситуация может случиться и с другими адресами, отвечающие за иные игровые функции. Это может дать тебе подсказку о том, как работает код данной функции.
			</p>
		</div>
		<p>
			Замороженные адреса (а точнее читы) хранятся в одноименном файле .cht, который находится в папке cheats. Если оставить заморозку адресов включенной и закрыть ROM, то при следующем запуске игры в окне эмулятора будет отображено количество активных читов, которые, вероятно, будут только мешать, если они тебе больше не нужны.
		</p>
		<p>
			<img src="1.png">
		</p>
		<p>
			Чтобы исправить ситуацию, разморозь адреса через Hex Editor или удали/деактивируй читы в окне Cheats.
		</p>
		<h3>Freeze/Unfreeze Address</h3>
		<p>
			Предварительно можно выделить сразу несколько адресов для заморозки/разморозки некого диапазона.
		</p>
		<p class="tip">
			В состоянии заморозки могут находиться одновременно не более 256-ти адресов. Если точнее, то количество читов в окне Cheats не может быть более 256-ти.
		</p>
		<h4>Toggle state</h4>
		<p>
			Переключает состояние адреса на замороженный/размороженный.
		</p>
		<p class="tip">
			Если байт был разморожен, он заморозится. Если был заморожен, то разморозится.
		</p>
		<p class="tip">
			Возможно для заморозки будет удобнее пользоваться именно этой опцией на размороженных адресах, а не Freeze, так как Toggle находится вверху списка.
		</p>
		<h4>Freeze</h4>
		<p>
			Замораживает байт в адресе. Байт перекрасится в синий цвет, и изменить его можно будет лишь через окно Cheats.
		</p>
		<p>
			<img src="3.png">
		</p>
		<p class="tip">
			Если байт уже был заморожен, ничего не изменится.
		</p>
		<p class="tip">
			Замороженный байт в основной RAM не отображается в зеркалах, а также замороженное зеркало не отображается в основной RAM и в двух других зеркалах. Заморозка зеркал не влияет на основную RAM.
		</p>
		<p class="tip">
			Если в окне Cheats отключена опция Enable cheats, заморозка не сработает, несмотря на то, что байт все равно будет выделен синим цветом (когда он не изменяется).
		</p>
		<h4>Unfreeze</h4>
		<p>
			Размораживает байт в адресе.
		</p>
		<p class="tip">
			Если байт уже был разморожен, ничего не изменится.
		</p>
		<p>
			Если во время того, как байт в адресе был заморожен, игра пыталась изменить байт в этом адресе, то после разморозки ты увидишь байт, который оказался в результате последней такой попытки.
		</p>
		<p>
			Если же игра не пыталась изменить байт, то он таким и останется после разморозки.
		</p>
		<p class="tip">
			Однако может быть и такое, что результатом последней попытки изменить байт окажется тот же самый байт, который ты замораживал.
		</p>
		<p class="tip">
			Для отслеживания байтов, которые игра пытается записать в адрес во время заморозки, можно просматривать зеркало этого адреса в Hex Editor'е. Еще можно воспользоваться Write брейкпоинтом, либо записать лог через окно Trace Logger и затем изучить его.
		</p>
		<h4>Unfreeze all</h4>
		<p>
			Аналогично Unfreeze, только размораживает сразу все замороженные адреса. Предварительно можно кликнуть по любому адресу RAM.
		</p>
		<script src="https://iromhacker.ru/spoiler.js"></script>
		<script src="https://iromhacker.ru/tab.js"></script>
	</body>
</html>