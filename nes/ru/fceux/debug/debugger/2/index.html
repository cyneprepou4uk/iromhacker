<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html">
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<title>ЯРомхакеръ. Debugger. Регистры и флаги</title>
		<meta name="description" content="При работе с дебаггером эмулятора FCEUX ты можешь вручную изменять переменные в регистрах и состояния флагов">
		<meta name="keywords" content="">
		<link rel="icon" href="https://iromhacker.ru/favicon.png" type="image/png">
		<link href="https://iromhacker.ru/style.css" rel="stylesheet">
		<script src="https://iromhacker.ru/analytics.js"></script>
	</head>
	<body>
		<h1>Регистры и флаги</h1>
		<p>
			<center>
				<a href="https://iromhacker.ru/nes/ru/index.html">Вернуться на главную страницу</a>
			</center>
		</p>
		<br>
		<p class="title">
			Содержание
		</p>
		<ul>
			<li><a href="../1/index.html">Описание окна</a></li>
			<li>Регистры и флаги</li>
			<li><a href="../3/index.html">Брейкпоинты</a></li>
			<ul>
				<li><a href="../3-1/index.html">Хранение списка брейкпоинтов</a></li>
				<li><a href="../3-2/index.html">Создание брейкпоинтов</a></li>
				<li><a href="../3-3/index.html">Основные типы брейкпоинтов</a></li>
				<li><a href="../3-4/index.html">Дополнительные условия брейкпоинтов</a></li>
				<ul>
					<li><a href="../3-4-1/index.html">Операторы сравнения</a></li>
					<li><a href="../3-4-2/index.html">Арифметические операторы</a></li>
					<li><a href="../3-4-3/index.html">Логические операторы</a></li>
				</ul>
				<li><a href="../3-5/index.html">Прочие типы брейкпоинтов</a></li>
			</ul>
			<li><a href="../4/index.html">Кнопки для отладки кода</a></li>
			<li>Комментарии</li>
			<li>Редактирование кода</li>
			<ul>
				<li>Inline Assembler</li>
				<li>ROM Patcher</li>
			</ul>
			<li>Прочая информация в окне и его возможности</li>
		</ul>
		<br>
		<p class="tip">
			Значения регистров и состояния флагов хранятся в файлах сохранений эмулятора.
		</p>
		<p class="tip">
			Подробнее про регистры и флаги читай в разделах с командами процессора.
		</p>
		<h2>Регистры A, X и Y</h2>
		<p>
			Здесь отображены байты, которые в данный момент находятся в каждом из трех регистров.
		</p>
		<p>
			<img src="1.png">
		</p>
		<p class="tip">
			Регистр A - аккумулятор. X и Y - индексные регистры.
		</p>
		<p>
			Во время паузы эмулятора можно вручную перезаписывать байты в этих регистрах, что повлияет на результат работы команд, которым необходим байт в одном из этих регистров.
		</p>
		<button class="spoiler">Пример подмены байта в регистре</button>
		<div class="panel">
			<p>
				В адресе $0123 находится байт #$01. Имеется следующий код:
			</p>
			<p class="debugger">
				<text class="opcode">LDA</text> <text class="address">$0123</text> = #$01 ; загрузка байта из адреса $0123 в регистр A 
				<text class="opcode">STA</text> <text class="address">$0456</text> = #$00 ; запись байта из регистра A в адрес $0456
			</p>
			<p>
				После выполнения команды LDA в регистр A запишется байт #$01. Если не изменять байт в регистре A, то при выполнении команды STA в адрес $0456 будет записан байт #$01.
			</p>
			<p>
				Если же вручную перезаписать байт в регистре A на #$02, то при выполнении команды STA в адрес $0456 будет записан байт #$02, а не #$01.
			</p>
		</div>
		<h2>Status</h2>
		<p>
			Регистр статуса процессора (P) - регистр флагов. Здесь отображены состояния 8-ми различных флагов.
		</p>
		<p>
			<img src="2.png">
		</p>
		<p>
			Если галочка не стоит, это означает что состояние флага = 0. Если галочка стоит - состояние флага = 1.
		</p>
		<p class="tip">
			Все 8 флагов технически являются одним 8-битным регистром. Каждый бит этого регистра отвечает за определенный флаг.
		</p>
		<p>
			Кликая по галочкам, можно вручную менять состояние флагов на 0 или 1 во время паузы эмулятора, что повлияет на результат работы команд, которые считывают состояние флагов.
		</p>
		<button class="spoiler">Пример подмены состояния флага</button>
		<div class="panel">
			<p class="debugger">
				8100: <text class="opcode">LDA</text> <text class="address">$0123</text> = #$00
				8103: <text class="opcode">BEQ</text> <text class="address">$8108</text> ; перейти на адрес $8108 при выполнении условия "Z = 1"
				8105: <text class="opcode">STA</text> <text class="address">$0456</text> = #$00
				8108: <text class="opcode">STA</text> <text class="address">$0567</text> = #$00
			</p>
			<p>
				После выполнения команды LDA $0123 флаг Z будет = 1. Без подмены флага Z команда BEQ перейдет на адрес $8108, и байт из регистра A будет записан только в адрес $0567.
			</p>
			<p>
				Если же подменить состояние флага Z на 0, тогда после выполнения команды BEQ код выполнит команду по адресу $8105 вместо прыжка на $8108, что приведет к записи регистра A еще и в адрес $0456.
			</p>
		</div>
		<h2>Program Counter</h2>
		<p>
			Регистр PC, который содержит в себе адрес выполняемой команды из NES Memory. Адрес указан рядом с кнопкой Seek PC.
		</p>
		<p>
			<img src="4.png">
		</p>
		<p>
			Во время паузы эмулятора можно вручную менять адрес, по которому будет выполняться следующая команда.
		</p>
		<p class="tip">
			Подробнее читай в статье с кнопками.
		</p>
		<h2>Stack Pointer</h2>
		<p>
			Регистр указателя стека (SP). Стек располагается в NES Memory $0100-$01FF. Информация по стеку видна здесь.
		</p>
		<p>
			<img src="3.png">
		</p>
		<p>
			Справа от слова Stack показан адрес (указатель), в который будет помещен байт при следующем использовании стека. Под этим адресом отображен список байтов, которые находятся в диапазоне $0100-$01FF справа от этого указателя стека.
		</p>
		<p class="tip">
			Байт из текущего адреса $0176 не отображается в списке. Байт #$7D находится по соседнему адресу $0177.
		</p>
		<p class="tip">
			Если указатель стека = $01FF, то байты в списке не отображаются, поскольку адреса выше $01FF не относятся к стеку.
		</p>
		<p class="tip">
			Адрес SP нельзя изменить вручную. Он изменяется только при выполнении некоторых команд.
		</p>
		<br>
		<br>
		<br>
		<script src="https://iromhacker.ru/spoiler.js"></script>
	</body>
</html>